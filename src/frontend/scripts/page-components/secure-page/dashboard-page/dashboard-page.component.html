<!--
  ~ Copyright (C) 2016 AptiTekk, LLC. (https://AptiTekk.com/) - All Rights Reserved
  ~ Unauthorized copying of any part of AptiBook, via any medium, is strictly prohibited.
  ~ Proprietary and confidential.
  -->

<div class="container-fluid">
    <div class="row">

        <!-- Center Calendar Section -->
        <div class="hidden-xs hidden-sm col-md-9 col-lg-push-3 col-lg-7">
            <div class="full-height">
                <calendar [eventFeedUrl]="apiService.getApiUrlFromEndpoint('reservations')"
                          [hiddenStatuses]="['rejected', 'cancelled']"
                          [filterByUsers]="filterOnlyUsersEvents ? [currentUser] : null"
                          [filterByResourceCategories]="enabledResourceCategories"
                          (eventSelected)="reservationInfoModal.display($event)"></calendar>
            </div>
        </div>

        <!-- Right Toolbar / Filter Section -->
        <div class="hidden-xs hidden-sm col-md-3 col-lg-push-3 col-lg-2">
            <panel [type]="'primary'" [title]="'Calendar Filters'">
                <panel-body>
                    <div class="form-group">
                        <toggle-switch [(ngModel)]="filterOnlyUsersEvents"
                                       style="margin-right: 10px"></toggle-switch>
                        <label>Only My Reservations</label>
                    </div>
                    <h4>Category Filters</h4>
                    <hr/>
                    <div class="form-group" *ngFor="let resourceCategory of resourceCategories">
                        <toggle-switch [(ngModel)]="resourceCategory.enabled"
                                       (onToggle)="updateEnabledResourceCategories()"
                                       style="margin-right: 10px"></toggle-switch>
                        <label>{{resourceCategory.name}}</label>
                    </div>
                </panel-body>
            </panel>
        </div>

        <!-- Left Sidebar Section (Will be pulled to the left on large screens) -->
        <div class="col-xs-12 col-md-12 col-lg-pull-9 col-lg-3">

            <!-- Upcoming Reservations -->
            <div class="upcoming-reservations-section"
                 [@sidebarDisplayStatus]="makingNewReservation ? 'hidden' : 'visible'">
                <div style="height: calc(100vh - 195px)">
                    <upcoming-reservations-panel></upcoming-reservations-panel>
                    <button class="btn btn-primary btn-block" (click)="onNewReservationStart()">
                        <i class="fa fa-plus"></i>
                        New Reservation
                    </button>
                </div>
            </div>

            <!-- New Reservation -->
            <div class="new-reservation-section" style="opacity: 0; height: 0; overflow: hidden; pointer-events: none;"
                 [@sidebarDisplayStatus]="makingNewReservation ? 'visible' : 'hidden'">
                <new-reservation-panel (cancelled)="onCancelNewReservation()"></new-reservation-panel>
            </div>
        </div>

    </div>
</div>
<reservation-info-modal #reservationInfoModal></reservation-info-modal>
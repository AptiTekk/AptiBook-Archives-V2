<!--
  ~ Copyright (C) 2016 AptiTekk, LLC. (https://AptiTekk.com/) - All Rights Reserved
  ~ Unauthorized copying of any part of AptiBook, via any medium, is strictly prohibited.
  ~ Proprietary and confidential.
  -->

<ol class="breadcrumb">
	<li class="active">Reservation Management</li>
	<li class="active">Approval Queue</li>
</ol>

<div class="container-fluid">
	
	<div class="row">
		<div class="col-xs-12">
			<h3>Awaiting Your Decision</h3>
			<hr/>
			<datatable #awaitingUserTable
					   [selectableRows]="true"
					   (rowSelected)="awaitingOthersTable.deselectRows(); onReservationSelected(reservationsAwaitingUser[$event])"
					   (rowDeselected)="onReservationDeselected()">
				<datatable-column [orderable]="false"
								  [width]="'30px'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingUser">
						<span class="reservation-icon fa"
							  [class.fa-hourglass-half]="reservation.pending"
							  [class.text-primary]="reservation.pending"
							  [class.fa-check-circle]="reservation.approved"
							  [class.text-success]="reservation.approved"
							  [class.fa-times-circle]="reservation.rejected"
							  [class.text-danger]="reservation.rejected"></span>
					</datatable-cell>
				</datatable-column>
				<datatable-column [title]="'Requested On'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingUser">
						{{reservation.dateCreated | date:'EEEE, MMM d, yyyy, h:mm a'}}
					</datatable-cell>
				</datatable-column>
				<datatable-column [title]="'Requested By'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingUser">
						{{reservation.user.fullName}}
					</datatable-cell>
				</datatable-column>
				<datatable-column [title]="'Title'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingUser">
						{{reservation.title}}
					</datatable-cell>
				</datatable-column>
				<datatable-column [title]="'Start Time'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingUser">
						{{reservation.start | date:'EEEE, MMM d, yyyy, h:mm a'}}
					</datatable-cell>
				</datatable-column>
				<datatable-column [title]="'End Time'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingUser">
						{{reservation.end | date:'EEEE, MMM d, yyyy, h:mm a'}}
					</datatable-cell>
				</datatable-column>
			</datatable>
		</div>
		<div class="col-xs-12">
			<h3>Awaiting Others' Decisions</h3>
			<hr/>
			<datatable #awaitingOthersTable
					   [selectableRows]="true"
					   (rowSelected)="awaitingUserTable.deselectRows(); onReservationSelected(reservationsAwaitingOthers[$event]);"
					   (rowDeselected)="onReservationDeselected()">
				<datatable-column [orderable]="false"
								  [width]="'30px'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingOthers">
						<span class="reservation-icon fa"
							  [class.fa-check-circle]="reservation['usersDecision'].approved"
							  [class.text-success]="reservation['usersDecision'].approved"
							  [class.fa-times-circle]="reservation['usersDecision'].rejected"
							  [class.text-danger]="reservation['usersDecision'].rejected"></span>
					</datatable-cell>
				</datatable-column>
				<datatable-column [title]="'Requested On'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingOthers">
						{{reservation.dateCreated | date:'EEEE, MMM d, yyyy, h:mm a'}}
					</datatable-cell>
				</datatable-column>
				<datatable-column [title]="'Requested By'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingOthers">
						{{reservation.user.fullName}}
					</datatable-cell>
				</datatable-column>
				<datatable-column [title]="'Title'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingOthers">
						{{reservation.title}}
					</datatable-cell>
				</datatable-column>
				<datatable-column [title]="'Start Time'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingOthers">
						{{reservation.start | date:'EEEE, MMM d, yyyy, h:mm a'}}
					</datatable-cell>
				</datatable-column>
				<datatable-column [title]="'End Time'">
					<datatable-cell *ngFor="let reservation of reservationsAwaitingOthers">
						{{reservation.end | date:'EEEE, MMM d, yyyy, h:mm a'}}
					</datatable-cell>
				</datatable-column>
			</datatable>
		</div>
		
		<!--<div class="col-xs-10 col-md-8 col-lg-10">
			<panel title="{{pendingReservation.resource.name}}">
				<panel-body>
					&lt;!&ndash; Resource Image &ndash;&gt;
					<div class="col-xs-4 col-sm-2"
						 style="width: 175px;">
						<div class="form-group">
							<resource-image [resource]="pendingReservation.resource"></resource-image>
						</div>
					</div>
					<div class="col-xs-12 col-sm-10">
						<div class="row">
							<div class="col-xs-12 col-sm-5">
								<div class="form-group">
									<label>Reservation Title:</label>
									<input type="text"
										   readonly="readonly"
										   value="{{pendingReservation.title}}"
										   class="form-control">
								</div>
							</div>
							
							<div class="col-xs-12 col-sm-3">
								<div class="form-group">
									<label>Requested By:</label>
									<input type="text"
										   readonly="readonly"
										   value="{{pendingReservation.user.fullName}}"
										   class="form-control">
								</div>
							</div>
							<div class="col-xs-12 col-sm-4">
								<div class="form-group">
									<label>Requested On:</label>
									<input type="text"
										   readonly="readonly"
										   value="{{pendingReservation.dateCreated}}"
										   class="form-control">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-12 col-xs-6">
								<div class="form-group">
									<label>Reservation Start Time:</label>
									<input type="text"
										   readonly="readonly"
										   value="{{pendingReservation.start}}"
										   class="form-control">
								</div>
							</div>
							<div class="col-xs-12 col-xs-6">
								<div class="form-group">
									<label>Reservation End Time:</label>
									<input type="text"
										   readonly="readonly"
										   value="{{pendingReservation.end}}"
										   class="form-control">
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-12">
							<div *ngFor="let userGroup of pendingReservation.hierarchy">
								
								<div *ngIf="!(userGroup.root && !userGroup.decision)">
									<span style="font-weight: bold">{{userGroup.name}}</span>
									<span *ngIf="userGroup.decision">
										User
										<span style="font-weight: bold">{{userGroup.decision.user.fullName}}</span>
									</span>
									has
									<span class="label label-success"
										  *ngIf="userGroup.decision?.approved">approved</span>
									
									<span class="label label-danger"
										  *ngIf="userGroup.decision?.rejected">rejected</span>
									
									<span *ngIf="!userGroup.decision"
										  style="font-weight: bold">
										not yet decided upon
									</span>
									this Reservation.
									
									<span *ngIf="userGroup.overriddenBy">
										(<span class="label label-info">Overridden</span>
										by the decision of
										<span style="font-weight: bold">{{userGroup.overriddenBy.decision.user.fullName}}</span>
										to
										<span class="label label-success"
											  *ngIf="userGroup.overriddenBy.decision.approved">approve</span>
										<span class="label label-danger"
											  *ngIf="userGroup.overriddenBy.decision.rejected">reject</span>
										on behalf of the
										<span style="font-weight: bold">{{userGroup.overriddenBy.name}}</span>
										User Group.)
									</span>
								</div>
							</div>
						</div>
					</div>
				</panel-body>
			</panel>
		</div>-->
	</div>

</div>

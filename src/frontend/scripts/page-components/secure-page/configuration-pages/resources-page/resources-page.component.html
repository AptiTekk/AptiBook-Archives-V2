<!--
  ~ Copyright (C) 2016 AptiTekk, LLC. (https://AptiTekk.com/) - All Rights Reserved
  ~ Unauthorized copying of any part of AptiBook, via any medium, is strictly prohibited.
  ~ Proprietary and confidential.
  -->

<div class="container-fluid">
    <ol class="breadcrumb">
        <li><a [routerLink]="['', 'secure']">Home</a></li>
        <li class="active">Configuration</li>
        <li class="active">Resources</li>
    </ol>

    <div class="row">
        <!-- Resource Categories Selection Sidebar -->
        <div class="col-xs-12 col-md-3">

            <!-- Header Buttons -->
            <div class="btn-toolbar">

                <!-- Add Button -->
                <button class="btn btn-primary"
                        (click)="newCategoryModal.open()">
                    Add New Category
                </button>

                <!-- Edit Button -->
                <button class="btn btn-default"
                        (click)="editCategoryModal.open(currentResourceCategory)"
                        *ngIf="currentResourceCategory">
                    Edit This Category
                </button>
            </div>

            <hr/>

            <!-- Categories List -->
            <ul id="resource-categories-list">
                <li *ngFor="let resourceCategory of resourceCategories"
                    [class.selected]="currentResourceCategory && currentResourceCategory.name === resourceCategory.name"
                    [routerLink]="['', 'secure', 'configuration', 'resources', resourceCategory.name.toLowerCase()]">
                    {{resourceCategory.name}}
                </li>
            </ul>
        </div>

        <!-- Content Area -->
        <div class="col-xs-12 col-md-9" *ngIf="currentResourceCategory">

            <!-- Header Buttons -->
            <div class="row">
                <div class="col-xs-12">
                    <div class="btn-toolbar">

                        <!-- Add Button -->
                        <button class="btn btn-primary"
                                (click)="newResourceModal.open()">
                            Add New Resource
                        </button>
                    </div>

                    <hr/>
                </div>
            </div>

            <!-- Resource Cards -->
            <div class="row">
                <div class="col-xs-12 col-md-6 col-lg-4"
                     *ngFor="let resource of currentResourceCategory.resources">

                    <!-- Resource Card -->
                    <panel [type]="'primary'">
                        <panel-body>
                            <!-- Resource Image -->
                            <img [src]="apiService.getApiUrlFromEndpoint('/resources/' + resource.id + '/image')"
                                 height="150px" class="resource-panel-image"/>

                            <!-- Resource Name -->
                            <h3 class="resource-panel-title">{{resource.name}}</h3>
                            <hr/>
                            <span style="font-weight: bold">Reservation Approval Required:</span>
                            <br/>
                            {{resource.needsApproval ? 'Yes' : 'No'}}
                            <br/>
                            <span style="font-weight: bold">Owning User Group: </span>
                            <br/>
                            {{resource.owner.name}}
                        </panel-body>
                        <panel-footer>

                            <!-- Edit Button -->
                            <button class="btn btn-default" (click)="false">Edit</button>

                            <!-- Delete Button -->
                            <button class="btn btn-danger pull-right"
                                    (click)="resourceForDeletion = resource;resourceDeleteModal.open()">
                                Delete
                            </button>
                        </panel-footer>
                    </panel>
                </div>
            </div>
        </div>
    </div>
</div>

<new-category-modal #newCategoryModal
                    (submitted)="onNewCategory($event)">
</new-category-modal>

<edit-category-modal #editCategoryModal
                     (submitted)="onEditCategory($event)"
                     (deleted)="onDeleteCategory()">
</edit-category-modal>

<new-resource-modal #newResourceModal
                    (submitted)="onNewResource($event)">
</new-resource-modal>

<deletion-confirmation-modal #resourceDeleteModal
                             [message]="resourceForDeletion ? 'Are you sure you want to delete the \'' + resourceForDeletion.name + '\' Resource?' : ''"
                             [warning]="'This will delete all associated Reservations as well!'"
                             (confirm)="onDeleteResource()">
</deletion-confirmation-modal>
<!--
  ~ Copyright (C) 2016 AptiTekk, LLC. (https://AptiTekk.com/) - All Rights Reserved
  ~ Unauthorized copying of any part of AptiBook, via any medium, is strictly prohibited.
  ~ Proprietary and confidential.
  -->

<div class="row">
    <div class="col-xs-12 col-md-8">
        <div class="btn-toolbar">
            <button class="btn btn-primary" (click)="onAddNewUser()">Add New User</button>
        </div>
        <hr/>
        <datatable [selectableRows]="true">
            <datatable-column [orderable]="false" [width]="'30px'">
                <datatable-cell *ngFor="let user of users">
                    <img src="user.svg" width="30px"/>
                </datatable-cell>
            </datatable-column>
            <datatable-column [title]="'Email Address'">
                <datatable-cell *ngFor="let user of users"
                                (selected)="onUserSelected(user)"
                                (deselected)="onUserDeselected(user)">
                    {{user.emailAddress}}
                </datatable-cell>
            </datatable-column>
            <datatable-column [title]="'First Name'">
                <datatable-cell *ngFor="let user of users">
                    {{user.firstName}}
                </datatable-cell>
            </datatable-column>
            <datatable-column [title]="'Last Name'">
                <datatable-cell *ngFor="let user of users">
                    {{user.lastName}}
                </datatable-cell>
            </datatable-column>
            <datatable-column [title]="'Assigned User Groups'">
                <datatable-cell *ngFor="let user of users">
                    {{getUserGroupsNames(user).join(', ')}}
                </datatable-cell>
            </datatable-column>
        </datatable>
    </div>
    <div class="col-xs-12 col-md-4">
        <panel id="selected-user-panel"
               [class.has-footer]="selectedUser"
               [type]="'primary'"
               [title]="'Selected User'">
            <panel-body>
                <div *ngIf="!selectedUser">
                    <h3>Select a User by clicking on their row.</h3>
                </div>
                <div *ngIf="selectedUser">
                    <img src="user.svg" width="150px" style="float: left; padding-right: 20px;"/>
                    <h3>{{selectedUser.emailAddress}}</h3>
                    <hr/>
                </div>
            </panel-body>
            <panel-footer *ngIf="selectedUser">
                <button class="btn btn-default">Edit User</button>
                <button class="btn btn-danger pull-right"
                        [disabled]="isSelectedUserCurrentUser()"
                        (click)="userDeleteModal.open()">
                    Delete User
                </button>
            </panel-footer>
        </panel>
    </div>
</div>

<deletion-confirmation-modal #userDeleteModal
                             [message]="'Are you sure you want to delete the User \'' + selectedUser?.emailAddress + '\''"
                             [warning]="'All Reservations made by this User will also be deleted!'"
                             (confirm)="onDeleteSelectedUser()">
</deletion-confirmation-modal>

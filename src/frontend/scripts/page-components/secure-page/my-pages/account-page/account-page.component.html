<!--
  ~ Copyright (C) 2016 AptiTekk, LLC. (https://AptiTekk.com/) - All Rights Reserved
  ~ Unauthorized copying of any part of AptiBook, via any medium, is strictly prohibited.
  ~ Proprietary and confidential.
  -->

<div class="container">
    <ol class="breadcrumb">
        <li><a [routerLink]="['', 'secure']">Home</a></li>
        <li class="active">My Account</li>
    </ol>

    <div class="row">
        <div class="col-xs-12 col-md-6">
            <form (submit)="onAccountDetailsSubmit()">
                <h4>Personal Information</h4>
                <hr/>

                <alert [severity]="'danger'" [message]="alertMessage" [autoClose]="true"
                       (onAutoClose)="alertMessage = undefined"></alert>

                <alert [severity]="'info'" [message]="successMessage" [autoClose]="true"
                       (onAutoClose)="successMessage = undefined"></alert>

                <div class="form-group">
                    <label for="emailAddressField">Email Address:</label>
                    <input name="emailAddress" id="emailAddressField" class="form-control" [ngModel]="user.emailAddress"
                           readonly>
                </div>

                <div class="row">
                    <div class="col-xs-12 col-md-6">
                        <div class="form-group">
                            <label for="firstNameField">First Name:</label>
                            <input name="firstName" id="firstNameField" class="form-control"
                                   [(ngModel)]="user.firstName" maxlength="30">
                        </div>
                    </div>
                    <div class="col-xs-12 col-md-6">
                        <div class="form-group">
                            <label for="lastNameField">Last Name:</label>
                            <input name="lastName" id="lastNameField" class="form-control" [(ngModel)]="user.lastName"
                                   maxlength="30">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="phoneNumberField">Phone Number:</label>
                    <div class="input-group">
                        <span class="input-group-addon">
                            <i class="fa fa-phone"></i>
                        </span>
                        <input name="phoneNumber" id="phoneNumberField" class="form-control"
                               [(ngModel)]="user.phoneNumber" maxlength="30">
                    </div>
                </div>

                <div class="form-group">
                    <label for="locationField">Location:</label>
                    <div class="input-group">
                        <div class="input-group-addon">
                            <i class="fa fa-map-marker"></i>
                        </div>
                        <input name="location" id="locationField" class="form-control" [(ngModel)]="user.location"
                               maxlength="250">
                    </div>
                </div>

                <h4>Change Password</h4>
                <hr/>

                <alert [severity]="'info'" [message]="passwordSuccessMessage" [autoClose]="true"
                       (onAutoClose)="passwordSuccessMessage = undefined"></alert>

                <alert [severity]="'warning'"
                       [message]="!doPasswordsMatch() ? 'The Passwords do not match!' : undefined"></alert>

                <div class="row">
                    <div class="col-xs-12 col-md-6">
                        <div class="form-group">
                            <label for="newPasswordField">New Password:</label>
                            <div class="input-group">
                                <div class="input-group-addon">
                                    <i class="fa fa-asterisk"></i>
                                </div>
                                <input type="password" name="newPassword" id="newPasswordField" class="form-control"
                                       [(ngModel)]="user.newPassword" maxlength="30">
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-12 col-md-6">
                        <div class="form-group">
                            <label for="confirmPasswordField">Confirm Password:</label>
                            <div class="input-group">
                                <div class="input-group-addon">
                                    <i class="fa fa-asterisk"></i>
                                </div>
                                <input type="password" name="confirmPassword" id="confirmPasswordField"
                                       class="form-control" [(ngModel)]="user.confirmPassword" maxlength="30">
                            </div>
                        </div>
                    </div>
                </div>

                <hr/>

                <div class="btn-toolbar">
                    <button class="btn btn-primary"
                            disabled="{{successMessage != undefined || alertMessage != undefined || !doPasswordsMatch() ? 'disabled' : null}}">
                        Save Changes
                    </button>
                </div>
            </form>
        </div>
        <div class="col-xs-12 col-md-4">

            <div class="row">
                <div class="col-xs-12" *ngIf="user.admin || user.userGroups.length > 0">
                    <h4>Assigned Groups</h4>
                    <hr/>
                    <div *ngIf="user.admin">
                        <p>The admin account is automatically granted full permissions. No Groups need to be
                            assigned.</p>
                    </div>
                    <div *ngIf="!user.admin">
                        <tree [userGroup]="rootUserGroup" [selectable]="false" [dragAndDrop]="false"
                              [higlightedUserGroupIds]="user.userGroups"></tree>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-xs-12">
                    <h4>Email Notification Preferences</h4>
                    <hr/>
                </div>
            </div>

        </div>
    </div>

</div>